<div id="main-card" class="card-container">
  <div id="card-id" style="display: none">{{Front}}</div>

  <div id="logo-header"></div>

  {{#Tags}}
  <div class="tags-container">
    <span class="tag-label">Tags:</span> {{Tags}}
  </div>
  {{/Tags}}

  <div class="content front-text">{{Front}}</div>

  <hr id="answer" />

  <div class="content back-text">{{Back}}</div>
  <br />

  {{#Context}}
  <details>
    <summary>Contexto</summary>
    <br />
    {{Context}}
  </details>
  {{/Context}}

<div id="prompt-data" style="display: none;">
  <textarea class="anki-field-raw" data-key="Front">{{Front}}</textarea>
  <textarea class="anki-field-raw" data-key="Back">{{Back}}</textarea>
  <textarea class="anki-field-raw" data-key="Tags">{{Tags}}</textarea>
  <textarea class="anki-field-raw" data-key="Improve">{{Improve}}</textarea>
</div>

  <div class="ia-wrapper">
    <button
      class="ia-button"
      onclick="copyPrompt(this, 'explicar')"
      title="Explicaci√≥n detallada y t√©cnica"
    >
      ü§ñ Explicar
    </button>

    <button
      class="ia-button"
      onclick="copyPrompt(this, 'contexto')"
      title="Analog√≠as y casos de uso real"
    >
      üåç Contexto
    </button>

    <button
      class="ia-button"
      onclick="copyPrompt(this, 'grafico')"
      title="Generar diagrama Mermaid"
    >
      üé® Graficar
    </button>
  </div>
</div>

<link rel="stylesheet" href="_prism.css" />
<script src="_anki_conf_dev.js"></script>
<script src="_anki_tags.js"></script>
<script src="_anki_gamification.js"></script>
<script src="_anki_llm.js"></script>
<script src="_anki_tools.js"></script>

<script>
  (function () {
    setTimeout(() => {
      // El orquestador se encargar√° de bajar el JS pesado solo si hace falta
      if (typeof smartRender === "function") {
        smartRender();
      }
      if (typeof applyRandomizationFront === "function") {
        applyRandomizationFront();
      }

      if (typeof renderCardStyles === "function") {
        renderCardStyles("{{Tags}}");
      }

      const idElem = document.getElementById("card-id");
      if (typeof runFrontGamification === "function" && idElem) {
        runBackGamification(idElem.innerText);
      }
    }, 100);
  })();
</script>
